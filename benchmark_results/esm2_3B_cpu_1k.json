{
  "name": "cpu_benchmark_esm2_3B",
  "total_time": 2337.5849902629852,
  "metadata": {
    "model": "esm2_3B",
    "device": "cpu",
    "num_threads": 16,
    "input_file": "/data/user_data/anshulk/cafa6/data/train_sequences_benchmark_1k.fasta",
    "num_sequences": 1000,
    "mean_seq_length": 415.309,
    "max_seq_length": 6199
  },
  "timers": {
    "read_sequences": {
      "mean": 0.002373933792114258,
      "median": 0.002373933792114258,
      "std": 0.0,
      "min": 0.002373933792114258,
      "max": 0.002373933792114258,
      "p95": 0.002373933792114258,
      "p99": 0.002373933792114258,
      "total": 0.002373933792114258,
      "count": 1
    },
    "load_model": {
      "mean": 72.55732607841492,
      "median": 72.55732607841492,
      "std": 0.0,
      "min": 72.55732607841492,
      "max": 72.55732607841492,
      "p95": 72.55732607841492,
      "p99": 72.55732607841492,
      "total": 72.55732607841492,
      "count": 1
    },
    "tokenize": {
      "mean": 0.017240955716087705,
      "median": 0.014744043350219727,
      "std": 0.011550933872624996,
      "min": 0.002413511276245117,
      "max": 0.05881094932556152,
      "p95": 0.040591299533843966,
      "p99": 0.055493552684783905,
      "total": 0.7241201400756836,
      "count": 42
    },
    "forward": {
      "mean": 53.893815755844116,
      "median": 46.87608516216278,
      "std": 33.30812466347484,
      "min": 11.810818910598755,
      "max": 148.57274270057678,
      "p95": 126.80414364337912,
      "p99": 148.14403616905213,
      "total": 2263.540261745453,
      "count": 42
    },
    "mean_pool": {
      "mean": 0.016696719896225704,
      "median": 0.010892868041992188,
      "std": 0.025061493134258674,
      "min": 0.0022552013397216797,
      "max": 0.12908935546875,
      "p95": 0.05981801748275741,
      "p99": 0.12114117145538322,
      "total": 0.7012622356414795,
      "count": 42
    }
  },
  "batch_stats": {
    "total_batches": 42,
    "total_items": 1000,
    "batch_time": {
      "mean": 53.9278533856074,
      "median": 46.907026171684265,
      "std": 33.329865082468444,
      "min": 11.81801438331604,
      "max": 148.6486873626709,
      "p95": 126.86331012248985,
      "p99": 148.25858460664747,
      "total": 2264.969842195511
    },
    "throughput": {
      "mean": 0.6329684597376631,
      "median": 0.512387529018298,
      "std": 0.40337911760806716,
      "min": 0.15800696831237276,
      "max": 2.0307980022330785
    },
    "seq_length": {
      "mean": 405.4761904761905,
      "median": 354.5,
      "min": 65.0,
      "max": 1024.0
    }
  },
  "batch_details": [
    {
      "batch_time": 19.590970516204834,
      "batch_size": 24,
      "throughput": 1.2250541636080867,
      "max_seq_length": 65,
      "forward_time": 19.586116552352905
    },
    {
      "batch_time": 11.81801438331604,
      "batch_size": 24,
      "throughput": 2.0307980022330785,
      "max_seq_length": 98,
      "forward_time": 11.810836791992188
    },
    {
      "batch_time": 15.187155723571777,
      "batch_size": 24,
      "throughput": 1.5802827360721619,
      "max_seq_length": 125,
      "forward_time": 15.17952561378479
    },
    {
      "batch_time": 16.940142393112183,
      "batch_size": 24,
      "throughput": 1.4167531442804364,
      "max_seq_length": 137,
      "forward_time": 16.931684494018555
    },
    {
      "batch_time": 18.847575187683105,
      "batch_size": 24,
      "throughput": 1.2733733523283146,
      "max_seq_length": 151,
      "forward_time": 18.838122367858887
    },
    {
      "batch_time": 21.174333333969116,
      "batch_size": 24,
      "throughput": 1.1334477275606964,
      "max_seq_length": 170,
      "forward_time": 21.163281202316284
    },
    {
      "batch_time": 26.751554489135742,
      "batch_size": 24,
      "throughput": 0.8971441270729447,
      "max_seq_length": 184,
      "forward_time": 26.740330934524536
    },
    {
      "batch_time": 27.003652572631836,
      "batch_size": 24,
      "throughput": 0.888768655849319,
      "max_seq_length": 197,
      "forward_time": 26.991410970687866
    },
    {
      "batch_time": 27.001973867416382,
      "batch_size": 24,
      "throughput": 0.8888239103497948,
      "max_seq_length": 207,
      "forward_time": 26.988584995269775
    },
    {
      "batch_time": 28.179088354110718,
      "batch_size": 24,
      "throughput": 0.8516954025767451,
      "max_seq_length": 219,
      "forward_time": 28.10820198059082
    },
    {
      "batch_time": 30.30209755897522,
      "batch_size": 24,
      "throughput": 0.7920243789490212,
      "max_seq_length": 229,
      "forward_time": 30.28777241706848
    },
    {
      "batch_time": 30.601111888885498,
      "batch_size": 24,
      "throughput": 0.78428522751544,
      "max_seq_length": 244,
      "forward_time": 30.58609652519226
    },
    {
      "batch_time": 32.58270049095154,
      "batch_size": 24,
      "throughput": 0.7365871962228846,
      "max_seq_length": 259,
      "forward_time": 32.56649446487427
    },
    {
      "batch_time": 33.541162729263306,
      "batch_size": 24,
      "throughput": 0.7155387007219333,
      "max_seq_length": 267,
      "forward_time": 33.52364134788513
    },
    {
      "batch_time": 35.61025047302246,
      "batch_size": 24,
      "throughput": 0.6739632460092319,
      "max_seq_length": 280,
      "forward_time": 35.591999769210815
    },
    {
      "batch_time": 37.45952844619751,
      "batch_size": 24,
      "throughput": 0.6406914607713441,
      "max_seq_length": 294,
      "forward_time": 37.43951678276062
    },
    {
      "batch_time": 39.35325503349304,
      "batch_size": 24,
      "throughput": 0.6098606069453191,
      "max_seq_length": 309,
      "forward_time": 39.33084321022034
    },
    {
      "batch_time": 40.95799016952515,
      "batch_size": 24,
      "throughput": 0.5859662522663829,
      "max_seq_length": 320,
      "forward_time": 40.93577766418457
    },
    {
      "batch_time": 42.03243851661682,
      "batch_size": 24,
      "throughput": 0.5709875716706753,
      "max_seq_length": 328,
      "forward_time": 41.90841817855835
    },
    {
      "batch_time": 45.12791848182678,
      "batch_size": 24,
      "throughput": 0.5318215598546808,
      "max_seq_length": 340,
      "forward_time": 45.10244154930115
    },
    {
      "batch_time": 44.967355251312256,
      "batch_size": 24,
      "throughput": 0.5337205149351011,
      "max_seq_length": 349,
      "forward_time": 44.94353532791138
    },
    {
      "batch_time": 48.68613386154175,
      "batch_size": 24,
      "throughput": 0.4929534981819152,
      "max_seq_length": 360,
      "forward_time": 48.6497802734375
    },
    {
      "batch_time": 48.84493136405945,
      "batch_size": 24,
      "throughput": 0.4913508798102114,
      "max_seq_length": 372,
      "forward_time": 48.81910228729248
    },
    {
      "batch_time": 50.74611711502075,
      "batch_size": 24,
      "throughput": 0.4729425888014602,
      "max_seq_length": 387,
      "forward_time": 50.7192268371582
    },
    {
      "batch_time": 52.75859522819519,
      "batch_size": 24,
      "throughput": 0.4549021803213962,
      "max_seq_length": 397,
      "forward_time": 52.73049306869507
    },
    {
      "batch_time": 56.09057855606079,
      "batch_size": 24,
      "throughput": 0.42787934476398287,
      "max_seq_length": 407,
      "forward_time": 56.06267046928406
    },
    {
      "batch_time": 55.93139123916626,
      "batch_size": 24,
      "throughput": 0.4290971396969985,
      "max_seq_length": 417,
      "forward_time": 55.90239500999451
    },
    {
      "batch_time": 56.1640841960907,
      "batch_size": 24,
      "throughput": 0.4273193508543049,
      "max_seq_length": 428,
      "forward_time": 56.13457489013672
    },
    {
      "batch_time": 58.85125732421875,
      "batch_size": 24,
      "throughput": 0.4078077698116299,
      "max_seq_length": 443,
      "forward_time": 58.82081627845764
    },
    {
      "batch_time": 59.306570529937744,
      "batch_size": 24,
      "throughput": 0.40467691497833086,
      "max_seq_length": 451,
      "forward_time": 59.27596116065979
    },
    {
      "batch_time": 61.04306125640869,
      "batch_size": 24,
      "throughput": 0.39316507897906783,
      "max_seq_length": 465,
      "forward_time": 61.01146674156189
    },
    {
      "batch_time": 63.11218976974487,
      "batch_size": 24,
      "throughput": 0.3802751906970795,
      "max_seq_length": 479,
      "forward_time": 63.08106994628906
    },
    {
      "batch_time": 65.41571021080017,
      "batch_size": 24,
      "throughput": 0.36688434510090495,
      "max_seq_length": 499,
      "forward_time": 65.38311266899109
    },
    {
      "batch_time": 70.5765209197998,
      "batch_size": 24,
      "throughput": 0.340056433601659,
      "max_seq_length": 526,
      "forward_time": 70.54179644584656
    },
    {
      "batch_time": 76.18942975997925,
      "batch_size": 24,
      "throughput": 0.31500432639550624,
      "max_seq_length": 568,
      "forward_time": 76.1520323753357
    },
    {
      "batch_time": 86.18362307548523,
      "batch_size": 24,
      "throughput": 0.2784751805917841,
      "max_seq_length": 624,
      "forward_time": 86.14242601394653
    },
    {
      "batch_time": 96.78991460800171,
      "batch_size": 24,
      "throughput": 0.24795971870829503,
      "max_seq_length": 688,
      "forward_time": 96.74485850334167
    },
    {
      "batch_time": 107.7742018699646,
      "batch_size": 24,
      "throughput": 0.2226878008241462,
      "max_seq_length": 771,
      "forward_time": 107.72286057472229
    },
    {
      "batch_time": 127.86800003051758,
      "batch_size": 24,
      "throughput": 0.18769355893790507,
      "max_seq_length": 904,
      "forward_time": 127.8084499835968
    },
    {
      "batch_time": 147.69721722602844,
      "batch_size": 24,
      "throughput": 0.16249459841394032,
      "max_seq_length": 1024,
      "forward_time": 147.52713251113892
    },
    {
      "batch_time": 148.6486873626709,
      "batch_size": 24,
      "throughput": 0.16145450340536913,
      "max_seq_length": 1024,
      "forward_time": 148.5727734565735
    },
    {
      "batch_time": 101.26135683059692,
      "batch_size": 16,
      "throughput": 0.15800696831237276,
      "max_seq_length": 1024,
      "forward_time": 101.18337535858154
    }
  ],
  "memory_snapshots": [
    {
      "timestamp": 72.56418657302856,
      "label": "after_model_load",
      "cpu_memory": {
        "rss": 1061679104,
        "vms": 22422368256,
        "rss_mb": 1012.49609375,
        "vms_mb": 21383.63671875
      },
      "system_memory": {
        "total": 1081486479360,
        "available": 861716295680,
        "percent": 20.3,
        "total_gb": 1007.2127723693848,
        "available_gb": 802.5358390808105
      }
    },
    {
      "timestamp": 92.15586471557617,
      "label": "batch_0",
      "cpu_memory": {
        "rss": 13037379584,
        "vms": 22699245568,
        "rss_mb": 12433.4140625,
        "vms_mb": 21647.6875
      },
      "system_memory": {
        "total": 1081486479360,
        "available": 837833752576,
        "percent": 22.5,
        "total_gb": 1007.2127723693848,
        "available_gb": 780.2934875488281
      }
    },
    {
      "timestamp": 315.36412525177,
      "label": "batch_10",
      "cpu_memory": {
        "rss": 13293314048,
        "vms": 22699307008,
        "rss_mb": 12677.4921875,
        "vms_mb": 21647.74609375
      },
      "system_memory": {
        "total": 1081486479360,
        "available": 772968407040,
        "percent": 28.5,
        "total_gb": 1007.2127723693848,
        "available_gb": 719.882926940918
      }
    },
    {
      "timestamp": 697.6002511978149,
      "label": "batch_20",
      "cpu_memory": {
        "rss": 13465047040,
        "vms": 22870855680,
        "rss_mb": 12841.26953125,
        "vms_mb": 21811.34765625
      },
      "system_memory": {
        "total": 1081486479360,
        "available": 644404776960,
        "percent": 40.4,
        "total_gb": 1007.2127723693848,
        "available_gb": 600.1487159729004
      }
    },
    {
      "timestamp": 1246.026081085205,
      "label": "batch_30",
      "cpu_memory": {
        "rss": 13522407424,
        "vms": 22927872000,
        "rss_mb": 12895.97265625,
        "vms_mb": 21865.72265625
      },
      "system_memory": {
        "total": 1081486479360,
        "available": 795722551296,
        "percent": 26.4,
        "total_gb": 1007.2127723693848,
        "available_gb": 741.0743751525879
      }
    },
    {
      "timestamp": 2236.2869522571564,
      "label": "batch_40",
      "cpu_memory": {
        "rss": 13798404096,
        "vms": 23202631680,
        "rss_mb": 13159.18359375,
        "vms_mb": 22127.75390625
      },
      "system_memory": {
        "total": 1081486479360,
        "available": 826957508608,
        "percent": 23.5,
        "total_gb": 1007.2127723693848,
        "available_gb": 770.1641960144043
      }
    },
    {
      "timestamp": 2337.573263168335,
      "label": "final",
      "cpu_memory": {
        "rss": 13639880704,
        "vms": 23034859520,
        "rss_mb": 13008.00390625,
        "vms_mb": 21967.75390625
      },
      "system_memory": {
        "total": 1081486479360,
        "available": 789644599296,
        "percent": 27.0,
        "total_gb": 1007.2127723693848,
        "available_gb": 735.4138412475586
      }
    }
  ]
}